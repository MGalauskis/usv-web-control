<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USV Control</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/virtual-joystick.css">
    <link rel="stylesheet" href="css/leaflet.min.css">
</head>
<body>

<div class="header">
    <h1>USV Control</h1>
    <div class="status-bar">
        <div class="status-indicator">
            <div class="status-dot" id="ws-status"></div>
            <span id="ws-status-text">Disconnected</span>
        </div>
        <div class="status-indicator">
            <div class="status-dot" id="joy-status"></div>
            <span id="joy-status-text">No joystick</span>
        </div>
        <div class="status-indicator latency-indicator" id="latency-indicator" style="display: none;">
            <canvas id="latency-graph" width="120" height="28"></canvas>
            <span id="latency-text">— ms</span>
        </div>
        <div class="status-indicator bandwidth-indicator" id="bandwidth-indicator" style="display: none;">
            <span>↓</span>
            <span id="bandwidth-text">0 KB/s</span>
        </div>
        <div class="status-indicator resource-indicator" id="cpu-indicator" style="display: none;">
            <span class="resource-label">CPU</span>
            <div class="resource-bar"><div class="resource-bar-fill" id="cpu-bar-fill"></div></div>
            <span class="resource-value" id="cpu-text">—%</span>
        </div>
        <div class="status-indicator resource-indicator" id="gpu-indicator" style="display: none;">
            <span class="resource-label">GPU</span>
            <div class="resource-bar"><div class="resource-bar-fill" id="gpu-bar-fill"></div></div>
            <span class="resource-value" id="gpu-text">—%</span>
        </div>
        <button id="fullscreen-btn" class="viewer-btn" title="Fullscreen control view">⛶</button>
    </div>
</div>

<div class="main">
    <!-- Joystick Panel -->
    <div class="panel">
        <div class="panel-header">Joystick</div>
        <div class="panel-body">
            <div class="joy-status" id="joy-device-name">Connect a USB joystick to begin</div>

            <!-- Virtual joystick: interactive when no USB gamepad, read-only indicator when USB active -->
            <div id="virtual-joy-container"></div>

            <div class="axes-grid" id="axes-grid"></div>
            <div class="buttons-grid" id="buttons-grid"></div>
        </div>
    </div>

    <!-- Topics Panel -->
    <div class="panel">
        <div class="panel-header">ROS2 Topics</div>
        <div class="panel-body">
            <div class="topics-list" id="topics-list">
                <div class="log-line" style="color: var(--text-dim)">Waiting for connection...</div>
            </div>
        </div>
    </div>

    <!-- Cameras Panel (hidden until cameras are available) -->
    <div class="panel" id="cameras-panel" style="display: none;">
        <div class="panel-header">Cameras</div>
        <div class="panel-body">
            <div class="topics-list" id="cameras-list"></div>
        </div>
    </div>

    <!-- Map Panel -->
    <div class="panel" id="map-panel" style="grid-column: 1 / -1;">
        <div class="panel-header"><span>Map</span></div>
        <div class="panel-body"></div>
    </div>

    <!-- Topic Viewers Area -->
    <div id="viewer-area" style="grid-column: 1 / -1;"></div>

    <!-- Log Panel -->
    <div class="panel" style="grid-column: 1 / -1;">
        <div class="panel-header">Log</div>
        <div class="panel-body">
            <div class="log-output" id="log-output"></div>
        </div>
    </div>
</div>

<script src="js/connection.js"></script>
<script src="js/joystick.js"></script>
<script src="js/virtualJoystick.js"></script>
<script src="js/inputManager.js"></script>
<script src="js/fullscreen.js"></script>
<script src="js/lib/jmuxer.min.js"></script>
<script src="js/lib/leaflet.min.js"></script>
<script src="js/viewers/Viewer.js"></script>
<script src="js/viewers/GenericViewer.js"></script>
<script src="js/viewers/ImageViewer.js"></script>
<script src="js/mapPanel.js"></script>
<script src="js/app.js"></script>

</body>
</html>
